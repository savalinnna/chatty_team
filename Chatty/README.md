# Subscription Service

**Subscription Service** ‚Äî –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –ª–µ–Ω—Ç—ã (feed) –Ω–∞ –æ—Å–Ω–æ–≤–µ —ç—Ç–∏—Ö –ø–æ–¥–ø–∏—Å–æ–∫. –û–Ω –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å Auth –∏ Post —Å–µ—Ä–≤–∏—Å–∞–º–∏ —á–µ—Ä–µ–∑ HTTP –∏ –∫—ç—à–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ—Ç–∫–ª–∏–∫–∞.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–¥–ø–∏—Å–∫–∞ / –æ—Ç–ø–∏—Å–∫–∞ –ø–æ `user_id` –∏ `username`
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫ –∏ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–Ω—Ç—ã –ø–æ—Å—Ç–æ–≤ –æ—Ç –ø–æ–¥–ø–∏—Å–æ–∫
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–Ω—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å Redis)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Auth –∏ Post Service
- JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11
- FastAPI
- SQLAlchemy 2.0
- Alembic
- PostgreSQL
- Docker / Docker Compose
- Redis (–¥–ª—è –∫—ç—à–∞)
- HTTPX (–∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è Auth –∏ Post)
- Pytest

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
subscription_service/
‚îú‚îÄ‚îÄ alembic/                   # –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ clients/               # HTTP-–∫–ª–∏–µ–Ω—Ç—ã –¥–ª—è –¥—Ä—É–≥–∏—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_client.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ post_client.py
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ deps.py            # JWT –∏ Depends
‚îÇ   ‚îú‚îÄ‚îÄ database.py            # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # SQLAlchemy-–º–æ–¥–µ–ª–∏ (Subscription)
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py             # Pydantic-—Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ services/              # –°–µ—Ä–≤–∏—Å—ã, –ª–æ–≥–∏–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subscription_service.py
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cache.py           # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ routers/
‚îÇ       ‚îî‚îÄ‚îÄ subscriptions.py   # –†–æ—É—Ç—ã –ø–æ–¥–ø–∏—Å–æ–∫
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ alembic.ini
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone https://github.com/your-org/subscription_service.git
cd subscription_service

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Docker Compose
docker-compose up --build
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
üîó `http://localhost:8007`

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤—É –º–∞—Ä—à—Ä—É—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º JWT-—Ç–æ–∫–µ–Ω:

```
Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>
```

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:8007/docs
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
pytest
```

–¢–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç:
- –ü–æ–¥–ø–∏—Å–∫—É / –æ—Ç–ø–∏—Å–∫—É
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∏–¥–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Auth –∏ Post —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚öôÔ∏è CI/CD

–ü–æ push –∏–ª–∏ PR:
- –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
- –ü—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–ª–∏–Ω—Ç–µ—Ä—ã)
- –í–æ–∑–º–æ–∂–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –≤ staging/production

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–ª—É—á–∞—é—Ç—Å—è –∏–∑ Auth Service
- –ü–æ—Å—Ç—ã –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Å–ø–∏—Å–∫—É –ø–æ–¥–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ Post Service
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–∏–¥–∞



# Admin Service

Admin Service ‚Äî —ç—Ç–æ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –û–Ω –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—é –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ REST API, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—è —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏ (Auth, Post –∏ —Ç.–¥.).

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ / —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π (user ‚Üî admin)
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–≤ —Ç–∞–±–ª–∏—Ü—É –∏ Sentry)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–æ JWT
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Auth –∏ Post Service

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python 3.11
- FastAPI
- SQLAlchemy
- Alembic
- Docker / Docker Compose
- PostgreSQL
- REST API
- Pytest

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
admin_service/
‚îú‚îÄ‚îÄ alembic/                   # –ú–∏–≥—Ä–∞—Ü–∏–∏ Alembic
‚îú‚îÄ‚îÄ app/                       # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ database.py            # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ dependencies.py        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤, –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ main.py                # –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è FastAPI
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # –ú–æ–¥–µ–ª–∏ SQLAlchemy (–Ω–∞–ø—Ä–∏–º–µ—Ä, AuditLog)
‚îÇ   ‚îú‚îÄ‚îÄ routers/               # –†–æ—É—Ç–µ—Ä—ã (users, content, stats)
‚îÇ   ‚îú‚îÄ‚îÄ schemas.py             # Pydantic-—Å—Ö–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ utils.py               # –õ–æ–≥–∏–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, Sentry
‚îú‚îÄ‚îÄ tests/                     # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏ —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ alembic.ini                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Alembic
‚îú‚îÄ‚îÄ app.py                     # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ config.py                  # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docker-entrypoint.sh       # –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îú‚îÄ‚îÄ Dockerfile                 # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è —Å–±–æ—Ä–∫–∏ Docker-–æ–±—Ä–∞–∑–∞
‚îú‚îÄ‚îÄ main.py                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ FastAPI
‚îú‚îÄ‚îÄ README.md                  # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ requirements.txt           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
git clone https://github.com/your-org/admin_service.git
cd admin_service

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é Docker Compose
docker-compose up --build
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:  
üîó `http://localhost:8002`

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–¥–∞—á–∏ JWT-—Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:
```
Authorization: Bearer <–≤–∞—à_—Ç–æ–∫–µ–Ω>
```

–¢–æ–ª—å–∫–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å —Ä–æ–ª—å—é `admin` –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è.

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

Swagger UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:
```
http://localhost:8002/docs
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest
```

–¢–µ—Å—Ç—ã –≤–∫–ª—é—á–∞—é—Ç:
- –ü–æ–∑–∏—Ç–∏–≤–Ω—ã–µ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Auth –∏ Post —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫—É –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## ‚öôÔ∏è CI/CD

–ü—Ä–∏ –∫–∞–∂–¥–æ–º `push` –∏–ª–∏ `pull request` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è:
- –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
- –ü—Ä–æ–≥–æ–Ω —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ GitHub Actions
- –û—Ç—á—ë—Ç –æ–± –æ—à–∏–±–∫–∞—Ö, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Å—ã–ª–æ–∫ –Ω–∞ Auth/Post —Å–µ—Ä–≤–∏—Å—ã.
- –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î –∏/–∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Sentry).
 
